# vaeda

vaeda (variaitonal auto-encoder (vae) for doublet annotation (da)) is a python package for doublet annotation in single cell RNA-sequencing. For method details and comparisons to alternative doublet annotation tools, see our [pre-print](https://biorxiv.org/cgi/content/short/2022.04.15.488440v1).

#### Installation

You can install ```vaeda``` using conda and pip as follows:

```
conda create -n vaeda_env python=3.8
conda activate vaeda_env

pip3 install --upgrade tensorflow==2.8.0
pip3 install --upgrade tensorflow-probability==0.16.0
pip3 install 'scanpy[leiden]'==1.8.0
pip3 install typing-extensions==3.7.4 absl-py==0.10 six==1.15.0 wrapt==1.12.1 xlrd==1.2.0
pip3 install -i https://test.pypi.org/simple/ vaeda==0.0.29
```

#### Quick Start
```
import vaeda

...

res = vaeda.vaeda(adata)

```

Where:
* adata is an annotated data matrix with raw counts in adata.X
* res is adata updated with the encoding generated by vaeda stored in adata.obsm['vaeda_embedding'] and the doublet scores and calls stored in adata.obs['vaeda_scores'] and adata.obs['vaeda_calls'] respectively.

#### More detailed example

For a more detailed and accessible example, see ```./doc/vaeda_scanpy-pbmc3k-tutorial.ipynb```, where we modified a tutorial from ```scanpy``` [(https://scanpy-tutorials.readthedocs.io/en/latest/pbmc3k.html)](https://scanpy-tutorials.readthedocs.io/en/latest/pbmc3k.html) to illustrate how to use ```vaeda``` for doublet annotation.


#### Other doublet detection tools

* [scds](https://github.com/kostkalab/scds)
* [scDblFInder](https://github.com/plger/scDblFinder)
* [DoubletFinder](https://github.com/chris-mcginnis-ucsf/DoubletFinder)
* [Scrublet](https://github.com/AllonKleinLab/scrublet)
* [solo](https://github.com/calico/Solo)
